搜索关键词 java dstream transform
分为转换操作与输出操作
基础转换操作（其余跟rdd一样） 窗口转换操作
-----------------------------------【transform】
自定义函数对dstream的rdd进行转换操作，和DStream其他普通的Transformation类操作的区别是可以使用所有RDD上的操作算子。
transform转换函数里是不能有关于rdd的action操作或者输出操作
在每个batch批次间隔间被调用
transform是将当前的DStream转换为另一个DStream(TransformedDStream)，并将自身的函数传入
一个常用操作是用事实数据关联维度数据，而维度数据的特点是小数据量且慢变的。可以在transform中实现关联维度数据，并不断更新维度数据
https://blog.csdn.net/qq_27639777/article/details/89893190

案例：广告计费日志实时黑名单过滤
https://www.cnblogs.com/weiyiming007/p/11353003.html


dstream.foreachRDD { rdd =>
rdd.foreachPartition { partitionOfRecords =>
    // 从数据库连接池中获取连接
    val connection = ConnectionPool.getConnection()
    partitionOfRecords.foreach(record => connection.send(record))
    ConnectionPool.returnConnection(connection) // 用完以后将连接返    回给连接池，进行复用
}
}

带连接池的案例
https://blog.csdn.net/Anbang713/article/details/82047674

